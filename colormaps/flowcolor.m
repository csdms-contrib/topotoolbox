function y = flowcolor(n)
% colormap for the display of flow accumulation
%
% Syntax
%
%     y = flowcolor(n)
%
% Description
%
%     flowcolor provides a nice colormap for the display of flow 
%     accumulation grids draped over digital elevation models.
%
% Example
%
%
% Author: Francois Beauducel <beauducel@ipgp.fr>
% Date: 2012/05/17


J = [ ...
    0.9686    0.9843    1.0000
    0.9655    0.9823    0.9990
    0.9624    0.9804    0.9980
    0.9592    0.9784    0.9970
    0.9561    0.9764    0.9961
    0.9530    0.9745    0.9951
    0.9499    0.9725    0.9941
    0.9468    0.9705    0.9931
    0.9437    0.9686    0.9921
    0.9405    0.9666    0.9911
    0.9374    0.9646    0.9902
    0.9343    0.9627    0.9892
    0.9313    0.9607    0.9882
    0.9282    0.9587    0.9872
    0.9251    0.9568    0.9862
    0.9220    0.9548    0.9852
    0.9189    0.9528    0.9843
    0.9158    0.9508    0.9833
    0.9128    0.9489    0.9823
    0.9097    0.9469    0.9813
    0.9066    0.9449    0.9803
    0.9036    0.9430    0.9793
    0.9005    0.9410    0.9783
    0.8975    0.9390    0.9774
    0.8944    0.9371    0.9764
    0.8914    0.9351    0.9754
    0.8884    0.9331    0.9744
    0.8853    0.9312    0.9734
    0.8823    0.9292    0.9724
    0.8793    0.9272    0.9715
    0.8762    0.9253    0.9705
    0.8732    0.9233    0.9695
    0.8702    0.9213    0.9685
    0.8672    0.9194    0.9675
    0.8643    0.9174    0.9666
    0.8614    0.9154    0.9656
    0.8586    0.9135    0.9647
    0.8557    0.9115    0.9638
    0.8530    0.9096    0.9629
    0.8502    0.9076    0.9619
    0.8475    0.9057    0.9610
    0.8447    0.9037    0.9601
    0.8420    0.9018    0.9593
    0.8393    0.8998    0.9584
    0.8366    0.8979    0.9575
    0.8339    0.8959    0.9566
    0.8312    0.8940    0.9557
    0.8285    0.8920    0.9548
    0.8257    0.8901    0.9538
    0.8229    0.8881    0.9529
    0.8201    0.8862    0.9520
    0.8173    0.8842    0.9510
    0.8145    0.8822    0.9501
    0.8116    0.8803    0.9491
    0.8086    0.8783    0.9481
    0.8056    0.8763    0.9471
    0.8025    0.8743    0.9461
    0.7994    0.8724    0.9450
    0.7962    0.8704    0.9440
    0.7930    0.8684    0.9429
    0.7897    0.8664    0.9417
    0.7863    0.8644    0.9406
    0.7828    0.8624    0.9394
    0.7792    0.8603    0.9382
    0.7755    0.8583    0.9369
    0.7718    0.8563    0.9356
    0.7679    0.8543    0.9343
    0.7639    0.8523    0.9328
    0.7598    0.8504    0.9313
    0.7556    0.8484    0.9298
    0.7513    0.8465    0.9282
    0.7469    0.8446    0.9265
    0.7424    0.8427    0.9248
    0.7378    0.8407    0.9231
    0.7332    0.8388    0.9214
    0.7284    0.8369    0.9196
    0.7236    0.8350    0.9177
    0.7187    0.8330    0.9159
    0.7138    0.8311    0.9140
    0.7088    0.8291    0.9122
    0.7037    0.8272    0.9103
    0.6986    0.8252    0.9084
    0.6934    0.8231    0.9065
    0.6882    0.8211    0.9046
    0.6829    0.8190    0.9027
    0.6776    0.8169    0.9008
    0.6723    0.8148    0.8989
    0.6669    0.8127    0.8971
    0.6615    0.8104    0.8952
    0.6560    0.8082    0.8934
    0.6506    0.8059    0.8916
    0.6451    0.8036    0.8899
    0.6396    0.8012    0.8882
    0.6341    0.7988    0.8865
    0.6286    0.7963    0.8849
    0.6231    0.7938    0.8833
    0.6175    0.7912    0.8818
    0.6119    0.7885    0.8803
    0.6061    0.7857    0.8788
    0.6003    0.7828    0.8774
    0.5943    0.7798    0.8760
    0.5882    0.7768    0.8747
    0.5820    0.7736    0.8733
    0.5757    0.7704    0.8720
    0.5694    0.7671    0.8707
    0.5630    0.7638    0.8694
    0.5565    0.7604    0.8681
    0.5500    0.7569    0.8668
    0.5435    0.7534    0.8656
    0.5369    0.7499    0.8643
    0.5303    0.7463    0.8631
    0.5236    0.7427    0.8618
    0.5170    0.7390    0.8606
    0.5104    0.7353    0.8593
    0.5038    0.7316    0.8581
    0.4971    0.7279    0.8568
    0.4906    0.7242    0.8555
    0.4840    0.7205    0.8542
    0.4775    0.7168    0.8529
    0.4711    0.7130    0.8516
    0.4647    0.7093    0.8502
    0.4584    0.7056    0.8489
    0.4521    0.7020    0.8475
    0.4460    0.6983    0.8460
    0.4399    0.6947    0.8446
    0.4340    0.6911    0.8431
    0.4281    0.6876    0.8416
    0.4224    0.6841    0.8400
    0.4168    0.6806    0.8384
    0.4113    0.6772    0.8368
    0.4057    0.6738    0.8351
    0.4002    0.6704    0.8334
    0.3948    0.6670    0.8316
    0.3894    0.6636    0.8298
    0.3840    0.6603    0.8280
    0.3786    0.6569    0.8261
    0.3733    0.6535    0.8242
    0.3680    0.6502    0.8223
    0.3628    0.6468    0.8204
    0.3576    0.6435    0.8184
    0.3524    0.6401    0.8165
    0.3473    0.6368    0.8145
    0.3421    0.6334    0.8125
    0.3371    0.6301    0.8104
    0.3320    0.6267    0.8084
    0.3270    0.6233    0.8063
    0.3220    0.6199    0.8043
    0.3171    0.6165    0.8022
    0.3122    0.6131    0.8001
    0.3073    0.6096    0.7980
    0.3025    0.6062    0.7959
    0.2977    0.6027    0.7938
    0.2929    0.5992    0.7917
    0.2882    0.5957    0.7896
    0.2835    0.5921    0.7875
    0.2788    0.5885    0.7855
    0.2742    0.5849    0.7834
    0.2696    0.5813    0.7813
    0.2650    0.5776    0.7793
    0.2605    0.5739    0.7772
    0.2560    0.5702    0.7752
    0.2515    0.5664    0.7732
    0.2471    0.5626    0.7712
    0.2427    0.5588    0.7692
    0.2382    0.5549    0.7672
    0.2339    0.5509    0.7653
    0.2295    0.5470    0.7633
    0.2252    0.5430    0.7614
    0.2208    0.5390    0.7594
    0.2166    0.5349    0.7574
    0.2123    0.5308    0.7555
    0.2081    0.5267    0.7535
    0.2039    0.5226    0.7516
    0.1997    0.5185    0.7496
    0.1955    0.5144    0.7476
    0.1914    0.5102    0.7456
    0.1873    0.5061    0.7436
    0.1833    0.5019    0.7416
    0.1793    0.4977    0.7395
    0.1753    0.4935    0.7375
    0.1713    0.4894    0.7354
    0.1674    0.4852    0.7333
    0.1635    0.4810    0.7311
    0.1597    0.4769    0.7290
    0.1559    0.4727    0.7268
    0.1521    0.4686    0.7245
    0.1484    0.4645    0.7223
    0.1447    0.4604    0.7200
    0.1410    0.4563    0.7177
    0.1374    0.4522    0.7153
    0.1338    0.4482    0.7129
    0.1303    0.4441    0.7104
    0.1267    0.4401    0.7079
    0.1231    0.4362    0.7054
    0.1193    0.4322    0.7029
    0.1154    0.4282    0.7004
    0.1115    0.4243    0.6978
    0.1075    0.4203    0.6952
    0.1034    0.4164    0.6926
    0.0993    0.4124    0.6900
    0.0952    0.4085    0.6873
    0.0911    0.4046    0.6846
    0.0870    0.4007    0.6819
    0.0829    0.3968    0.6791
    0.0788    0.3928    0.6763
    0.0749    0.3889    0.6735
    0.0710    0.3850    0.6706
    0.0671    0.3811    0.6676
    0.0634    0.3772    0.6647
    0.0599    0.3733    0.6616
    0.0564    0.3694    0.6585
    0.0531    0.3655    0.6554
    0.0500    0.3616    0.6522
    0.0471    0.3577    0.6489
    0.0444    0.3537    0.6456
    0.0418    0.3498    0.6422
    0.0396    0.3459    0.6387
    0.0375    0.3419    0.6351
    0.0357    0.3380    0.6315
    0.0342    0.3340    0.6278
    0.0330    0.3301    0.6241
    0.0322    0.3261    0.6202
    0.0316    0.3221    0.6163
    0.0314    0.3181    0.6123
    0.0314    0.3141    0.6081
    0.0314    0.3101    0.6039
    0.0314    0.3061    0.5994
    0.0314    0.3021    0.5949
    0.0314    0.2981    0.5901
    0.0314    0.2941    0.5853
    0.0314    0.2901    0.5803
    0.0314    0.2860    0.5752
    0.0314    0.2820    0.5699
    0.0314    0.2780    0.5645
    0.0314    0.2739    0.5590
    0.0314    0.2699    0.5534
    0.0314    0.2659    0.5477
    0.0314    0.2618    0.5418
    0.0314    0.2577    0.5358
    0.0314    0.2537    0.5297
    0.0314    0.2496    0.5235
    0.0314    0.2456    0.5172
    0.0314    0.2415    0.5108
    0.0314    0.2374    0.5043
    0.0314    0.2333    0.4977
    0.0314    0.2293    0.4911
    0.0314    0.2252    0.4843
    0.0314    0.2211    0.4774
    0.0314    0.2170    0.4704
    0.0314    0.2129    0.4634
    0.0314    0.2088    0.4563
    0.0314    0.2047    0.4491
    0.0314    0.2006    0.4418
    0.0314    0.1965    0.4345
    0.0314    0.1924    0.4271
    0.0314    0.1882    0.4196
];

l = length(J);
if nargin < 1
	n = 255;
end
y = interp1(1:l,J,linspace(1,l,n),'*linear');
